<?xml version="1.0" encoding="UTF-8"?>

<deployment xmlns="urn:jboss:bean-deployer:2.0">

   <!-- the security management bean -->
   <bean name="JNDIBasedSecurityManagement" 
   				class="org.jboss.test.security.microcontainer.metadata.support.MockSecurityManagement"/>

   <!--  a regular application policy -->
   <application-policy xmlns="urn:jboss:security-beans:1.0" name="TestPolicy1">
      <authentication>
         <login-module code="org.jboss.security.auth.AuthModule1" flag="required">
            <module-option name="authOption1">value1</module-option>
            <module-option name="authOption2">value2</module-option>
         </login-module>
      </authentication>
      <authorization>
         <policy-module code="org.jboss.security.authz.AuthorizationModule1" flag="required">
            <module-option name="authzOption1">value1</module-option>
            <module-option name="authzOption2">value2</module-option>
         </policy-module>
      </authorization>
      <acl>
         <acl-module code="org.jboss.security.authz.ACLModule1" flag="required">
            <module-option name="aclOption1">value1</module-option>
            <module-option name="aclOption2">value2</module-option>
         </acl-module>
      </acl>
      <rolemapping>
         <mapping-module code="org.jboss.security.mapping.RoleMappingModule1">
            <module-option name="mappingOption1">value1</module-option>
            <module-option name="mappingOption2">value2</module-option>
         </mapping-module>
         <mapping-module code="org.jboss.security.mapping.RoleMappingModule2">
            <module-option name="mappingOption3">value3</module-option>
            <module-option name="mappingOption4">value4</module-option>
         </mapping-module>
      </rolemapping>
      <audit>
         <provider-module code="org.jboss.security.audit.AuditModule1">
            <module-option name="auditOption1">value1</module-option>
         </provider-module>
      </audit>
   </application-policy>

   <!-- an application policy that extends the previously declared TestPolicy1 policy -->
   <application-policy xmlns="urn:jboss:security-beans:1.0" name="TestPolicy2" extends="TestPolicy1">
      <authentication>
         <login-module code="org.jboss.security.auth.AuthModule2" flag="optional">
            <module-option name="authOption3">value3</module-option>
            <module-option name="authOption4">value4</module-option>
         </login-module>
      </authentication>
      <authorization>
         <policy-module code="org.jboss.security.authz.AuthorizationModule2" flag="required">
            <module-option name="authzOption3">value3</module-option>
            <module-option name="authzOption4">value4</module-option>
         </policy-module>
      </authorization>
      <acl>
         <acl-module code="org.jboss.security.authz.ACLModule2" flag="required">
            <module-option name="aclOption3">value3</module-option>
            <module-option name="aclOption4">value4</module-option>
         </acl-module>
      </acl>
      <audit>
         <provider-module code="org.jboss.security.audit.AuditModule2">
            <module-option name="auditOption2">value2</module-option>
         </provider-module>
      </audit>
      <identity-trust>
         <trust-module code="org.jboss.security.trust.IdentityTrustModule1" flag="required">
            <module-option name="trustOption1">value1</module-option>
            <module-option name="trustOption2">value2</module-option>
         </trust-module>
      </identity-trust>
   </application-policy>

   <!-- an application policy using a jaspi configuration -->
   <application-policy xmlns="urn:jboss:security-beans:1.0" name="TestPolicy3">
      <authentication-jaspi>
         <login-module-stack name="ModuleStack1">
            <login-module code="org.jboss.security.auth.AuthModule3" flag="required">
               <module-option name="authOption5">value5</module-option>
            </login-module>
            <login-module code="org.jboss.security.auth.AuthModule4" flag="optional"/>
         </login-module-stack>
         <auth-module code="org.jboss.security.auth.AuthModule1" login-module-stack-ref="ModuleStack1"/>
      </authentication-jaspi>
   </application-policy>

   <!-- an application policy that extends the TestPolicy3 to specify new jaspi configurations -->
   <application-policy xmlns="urn:jboss:security-beans:1.0" name="TestPolicy4" extends="TestPolicy3">
      <authentication-jaspi>
         <login-module-stack name="ModuleStack2">
            <login-module code="org.jboss.security.auth.AuthModule5" flag="required">
               <module-option name="authOption6">value6</module-option>
               <module-option name="authOption7">value7</module-option>
            </login-module>
         </login-module-stack>
         <auth-module code="org.jboss.security.auth.AuthModule2" login-module-stack-ref="ModuleStack2">
            <module-option name="authOption1">value1</module-option>
            <module-option name="authOption2">value2</module-option>
         </auth-module>
      </authentication-jaspi>
   </application-policy>

</deployment>