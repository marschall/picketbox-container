<?xml version="1.0" encoding="UTF-8"?>

<deployment xmlns="urn:jboss:bean-deployer:2.0">

   <!-- the security management bean -->
   <bean name="JNDIBasedSecurityManagement" 
   				class="org.jboss.test.security.microcontainer.metadata.support.MockSecurityManagement"/>

   <!-- an application policy that specifies authentication and authorization configurations -->
   <application-policy xmlns="urn:jboss:security-beans:1.0" name="TestPolicy1">
      <authentication>
         <login-module code="org.jboss.security.auth.AuthModule1" flag="required">
            <module-option name="authOption1">value1</module-option>
            <module-option name="authOption2">value2</module-option>
         </login-module>
         <login-module code="org.jboss.security.auth.AuthModule2" flag="optional">
            <module-option name="authOption3">value3</module-option>
            <module-option name="authOption4">value4</module-option>
         </login-module>
      </authentication>
      <authorization>
         <policy-module code="org.jboss.security.authz.AuthorizationModule1" flag="required">
            <module-option name="authzOption1">value1</module-option>
            <module-option name="authzOption2">value2</module-option>
         </policy-module>
         <policy-module code="org.jboss.security.authz.AuthorizationModule2" flag="required">
            <module-option name="authzOption3">value3</module-option>
            <module-option name="authzOption4">value4</module-option>
         </policy-module>
      </authorization>
   </application-policy>

   <!-- an application policy that specifies authentication-jaspi and authorization configurations -->
   <application-policy xmlns="urn:jboss:security-beans:1.0" name="TestPolicy2">
      <authentication-jaspi>
         <login-module-stack name="ModuleStack1">
            <login-module code="org.jboss.security.auth.AuthModule3" flag="required">
               <module-option name="authOption5">value5</module-option>
            </login-module>
            <login-module code="org.jboss.security.auth.AuthModule4" flag="optional"/>
         </login-module-stack>
         <login-module-stack name="ModuleStack2">
            <login-module code="org.jboss.security.auth.AuthModule5" flag="required">
               <module-option name="authOption6">value6</module-option>
               <module-option name="authOption7">value7</module-option>
            </login-module>
         </login-module-stack>
         <auth-module code="org.jboss.security.auth.AuthModule1" login-module-stack-ref="ModuleStack1"/>
         <auth-module code="org.jboss.security.auth.AuthModule2" login-module-stack-ref="ModuleStack2">
            <module-option name="authOption1">value1</module-option>
            <module-option name="authOption2">value2</module-option>
         </auth-module>
      </authentication-jaspi>
      <authorization>
         <policy-module code="org.jboss.security.authz.AuthorizationModule1" flag="required">
            <module-option name="authzOption1">value1</module-option>
            <module-option name="authzOption2">value2</module-option>
         </policy-module>
         <policy-module code="org.jboss.security.authz.AuthorizationModule2" flag="required">
            <module-option name="authzOption3">value3</module-option>
            <module-option name="authzOption4">value4</module-option>
         </policy-module>
      </authorization>
   </application-policy>

</deployment>